#!/bin/zsh

# Usage: pullAppDataFile.sh  [AppIdentifier]

if [[ $1 == "" ]]; then
    echo -e "\e[31mNo argument entered.\e[m"
    exit 1
fi

userDataDirPath="/data/user/0/"
appUserDataDirPath=$userDataDirPath$1
tmpDirPath="/sdcard/"

targetDirList=`adb shell "su -c 'ls $appUserDataDirPath'"`
tmpDirList=`adb shell "su -c 'ls $tmpDirPath'"`

if [[ $targetDirList == "" ]]; then
    echo -e "\e[31m$1 not found\e[m"
    exit 1
elif [[ $tmpDirList == "" ]]; then
    echo -e "\e[31m$tmpDirPath not found\e[m"
    exit 1
fi

adb shell "su -c 'cp -r $appUserDataDirPath $tmpDirPath'"
adb pull $tmpDirPath$1 ./
adb shell "su -c 'rm -rf $tmpDirPath$1'"